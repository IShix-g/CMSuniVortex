[日本語](RelationshipsBetweenClasses_jp.md)

## Role of each class

### [CuvImporter](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvImporter.cs)

Manages CMS imports. Saves necessary states.

#### Content being saved

- Build destination path
- Target languages (array) 
- Currently used `CuvClient`

<img src="assets/select_client.png" width="600"/>

### [CuvClient](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvClient.cs)

Determines which CMS to use and which model to employ. Once implemented, it shows up in the dropdown of `CuvImporter`.

#### CMS types

- Cockpit CMS
- Google Sheets

#### File reference method

- Direct reference
- Reference from [Addressables](https://docs.unity3d.com/Packages/com.unity.addressables@1.19/manual/index.html)

### Attributes used in CuvClient

#### `[IgnoreImporter]` attribute
When specified, it will not be displayed in the dropdown list of `CuvImporter`.

```csharp
[IgnoreImporter] // <--
public sealed class TestCockpitCuvClient : CockpitCuvClient<TestCockpitModel, TestCockpitCuvModelList>
{
    protected override JsonConverter<TestCockpitModel> CreateConverter()
        => new CuvModelConverter<TestCockpitModel>();
}

```

#### `[CuvDisplayName("Name")]` attribute
When specified, it allows you to change the name displayed in the dropdown list of `CuvImporter`.

```csharp
[CuvDisplayName("YourCustomName")] // <--
public sealed class TestCockpitCuvClient : CockpitCuvClient<TestCockpitModel, TestCockpitCuvModelList>
{
    protected override JsonConverter<TestCockpitModel> CreateConverter()
        => new CuvModelConverter<TestCockpitModel>();
}

```

### [CuvModelList](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvModelList.cs)

Generated by `CuvClient`. Saves data in target language-specific `ScriptableObject`. The model is stored in arrays and can be obtained with a `Key`.

### [ICuvModel](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/ICuvModel.cs)

Model. Corresponds to one article of data in CMS.

### [ICuvOutput](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/ICuvOutput.cs)

Determines how to reference the `CuvModelList` and creates a `CuvReference`. Once implemented, it shows up in the dropdown of `CuvImporter`.

#### Types

- Direct reference
- Reference from [Addressables](https://docs.unity3d.com/Packages/com.unity.addressables@1.19/manual/index.html)

### [CuvReference](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvReference.cs)

A `ScriptableObject` that manages references to the `CuvModelList<T>` stored by language. The user extracts data from here.

## Component

### `CuvModelKey("ref")` Attribute

Although it's fine to use the created `CuvReference` directly, it's convenient to use this component because it displays a drop-down list of the configured `Key`.

<img src="assets/googleSheet/cuv_model_key.png" width="600"/>

Pass the field name of the `CuvReference` you want to reference as an argument.

```csharp
public abstract class Test : MonoBehaviour
{
    [SerializeField] GoogleSheetCuvReference _reference;
    [SerializeField, CuvModelKey("_reference")] string _key;

```

### CuvComponent

A class that wraps the `CuvModelKey` to simplify usage.

```csharp
using CMSuniVortex.Compornents;
using CMSuniVortex.GoogleSheet;
using UnityEngine;
using UnityEngine.UI;

public sealed class TestText : CuvComponent<GoogleSheetCuvReference>
{
    [SerializeField] Text _text;
        
    protected override void OnChangeLanguage(GoogleSheetCuvReference reference, string key)
    {
        if (reference.GetList().TryGetByKey(key, out var model))
        {
            _text.text = model.Text;
        }
    }
}
```

### CuvAsyncComponent

Asynchronous version of the `CuvComponent`.

### SetParam

By enclosing it with `{}`, you can embed parameters.

- Statement  `You have earned {number} coins.`
- Display `You have earned 5 coins.`

```csharp
var text = model.Text.SetParam("number", 5);
```