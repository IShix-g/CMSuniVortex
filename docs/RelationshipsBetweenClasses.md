[日本語](RelationshipsBetweenClasses_jp.md)

# Roles of Each Class

## [CuvImporter](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvImporter.cs)

Manages import from CMS. Saves the necessary state.

### What it Saves

- Path to build destination
- Target languages (array)
- Currently utilized `CuvClient`

## [CuvClient](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvClient.cs)

Determines which CMS to use and which model to utilize. If implemented, it will automatically appear in the dropdown menu in `CuvImporter`.

<img src="assets/select_client.png" width="600"/>

If you specify the `[IgnoreImporter]` attribute, it will be excluded from the `CuvImporter` dropdown menu and will not be displayed.

```csharp
[IgnoreImporter]
public sealed class TestCockpitCuvClient : CockpitCuvClient<TestCockpitModel, TestCockpitCuvModelList>
{
    protected override JsonConverter<TestCockpitModel> CreateConverter()
        => new CuvModelConverter<TestCockpitModel>();
}

```

## [CuvModelList<T>](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/CuvModelList.cs)

A data that saves data by target language. The model is saved as an array.

## ICuvModel

The model. Represents the data equivalent to one article in CMS.

# Explanation of Implementation

I believe understanding how the implemented Cockpit is implemented will deepen your understanding further.

[Click here for a list of implemented Cockpit files](https://github.com/IShix-g/CMSuniVortex/tree/main/Packages/CMSuniVortex/Runtime/Cockpit)

## ICuvModel

The [CockpitModel](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/Clients/Cockpit/CockpitModel.cs) is an `abstract class` that implements `ICuvModel`. It receives `Newtonsoft.Json.Linq.JObject` and returns data formatted to the subclasses. Here are some examples of such methods:

```csharp
public string GetString(string key) => Get<string>(key);

T Get<T>(string key)
    => JObject.TryGetValue(key, out var value)
       && value.Type != JTokenType.Null
        ? value.Value<T>()
        : default;
```

Here's how it's used from the subclass:

```csharp
public sealed class TestCockpitModel : CockpitModel
{
    public string Text;

    protected override void OnDeserialize()
    {
        Text = GetString("text");
    }
}
```

Since I don't know what kind of method can be implemented by CMS, I decided to create a class for each CMS.

## CuvModelList<T>

The [CockpitCuvModelList<T>](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/Clients/Cockpit/CockpitCuvModelList.cs) is a class for ensuring the `CockpitModel` with generic type. Also, because it inherits `ScriptableObject`, generic types cannot be used and it is an `abstract class`. Here's how it is implemented in a simple manner:

```csharp
public sealed class TestCockpitCuvModelList : CockpitCuvModelList<TestCockpitModel> {}
```

## CuvClient

In [CockpitCuvClient](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Runtime/Clients/Cockpit/CockpitCuvClient.cs), you describe a process to load data from CMS, create a model, and pass it to `CuvImporter`. This is also a `sealed class`. Here's how you implement it:

```csharp
public sealed class TestCockpitCuvClient : CockpitCuvClient<TestCockpitModel, TestCockpitCuvModelList>
{
    protected override JsonConverter<TestCockpitModel> CreateConverter()
        => new CuvModelConverter<TestCockpitModel>();
}
```

## List of Implemented Subclasses

To utilize `TestCockpitModel`, you need to create the following three scripts.
As it is cumbersome, it can be generated by the Script Generator.

- [TestCockpitCuvClient - CockpitCuvClient<TestCockpitModel, TestCockpitCuvModelList>](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Samples~/Import/Scripts/TestCockpitCuvClient.cs)
- [TestCockpitCuvModelList - CockpitCuvModelList<TestCockpitModel>](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Samples~/Import/Scripts/TestCockpitCuvModelList.cs)
- [TestCockpitModel - CockpitModel](https://github.com/IShix-g/CMSuniVortex/blob/main/Packages/CMSuniVortex/Samples~/Import/Scripts/TestCockpitModel.cs)